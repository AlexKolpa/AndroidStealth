\section{Approach and Design}
\label{sec:approach-and-design}
This section walks though all design choices made with DroidStealth,
and how we approached the problem in order to tackle it. Most 
solutions have drawbacks, which will be discussed further in the
section about future work and limitations. %% ADD REFERENCE

%% Here we say stuff about the libraries and intents because why reinvent the wheel. 
%% WHAT ELSE DO WE TALK ABOUT HERE EXACTLY BESIDES USER EXPERIENCE?
%% NOT SURE IF STRUCTURE HERE WORKS

\subsection{Encryption}
\label{sec:approach-and-design:encryption}

\subsection{Morphing}
\label{sec:approach-and-design:morphing}

Simply hiding a user's data will not be enough to pass the casual search that was described earlier. 
Anyone inspecting a phone that knows of DroidStealth and its functionality would become highly suspicious of any user with the application installed, resulting in more thorough inspection. 
This is something this application was not designed for, which could possibly result in the hidden data becoming compromised. 

From this it follows that not only the data needs to be hidden, but DroidStealth as well. 
Unfortunately, the Android framework does not provide many tools for this. 
This is mainly because the operating system, like most mobile operating systems, is focused on easy application access instead of easy file access. 
Preventing detection meant some unconventional approaches had to be assessed.

There are several obstacles when it comes to staying unnoticed through a casual search on Android. 
The most obvious obstacle is the `app drawer,' which is an overview of all the applications installed on the Android device.
In Android is possible to change the way the app drawer behaves, since it is itself an application as well.
However, changing the app drawer is a radical approach, which many users, especially those not technically literate, would not consider doing.
Since the product was meant to be as easy as possible to install and use, it meant that having an application that behaved as a custom app drawer was not an option.

This meant that the application would have to be able to hide itself.
It would have to be so unnoticeable between the user's other applications, casual search would not expose it immediately. 
Where it led us to another problem, since applications have a name and an icon that stays the same as long as they are not updated by the developer themselves.
Updating continuously would not be an option, since DroidStealth is meant for offline usage, as explained in section \ref{sec:problem-description}. 

Since the developers can not consistently update the appearance of the application, this means it is something the users would need to be able to do themselves.
To achieve this, a novel approach was taken.
For this project we devised a method to allow users to alter the name and icon of DroidStealth without developer intervention, a method which was dubbed `morphing' due to the now fluid appearances DroidStealth.
Unfortunately, due to limitations in Android, users would need to re-install the application after having `morphed' it, but this problem is addressed through the way users share the application.

As expressed in the section \ref{sec:problem-description}, the application should be able to be shared nomadically, meaning there is no central distribution point, but users share the application between each other. 
Combined with the morphing discussed in the previous paragraph, this provides for a good solution for the necessity of reinstalling the application for it to be morphed.
Users can create a morphed version which they can share with other users, so that the application never looks the same, making it near impossible to detect during a casual search.

Sharing the application can be achieved through a multitude of ways on Android, but because of the ease of use and the increasing implementation, Near Field Communication (NFC)\cite{website:nfc-spec} was chosen the main approach for data sharing. 
It is also possible to share through the default sharing system supported by Android,which includes BlueTooth and uploading files to various sharing services, for those devices that do not yet support NFC.

\subsection{User Experience}
\label{sec:approach-and-design:user-experience}

Within this subsection we will briefly elaborate on our design
choices in user experience design related to locking and hiding
of both data and the app. Finally, we briefly discuss the 
philosophy behind the styling. 

\subsubsection{Locking and Hiding of Data}

The most important part of this project, is the ability to hide
files. This means, as mentioned earlier, that hidden media
files should no longer be visible in the media
galleries, and that with a file browser, one still shouldn't be
able to open any of the hidden files, as they would be
encrypted. While the sensitive
files are hidden and locked away, the user wouldn't be able to
directly open the files. Therefore, the user should have the
ability to unlock files, so that the data can be viewed,
shared, and even modified.

Unlocking files potentially causes security risks, they may be
forgotten by the user. Then later found by a third party when the user thought they were safe.
This issue was solved by showing
a clear warning to the user, explaining that some files are
unlocked and that this presents a risk.
The user is shown a persistent notification in the
notification drawer of Android, with the message that some of
the user's files are unlocked. When the notification is pressed,
all unlocked files are immediately locked. This
provides a user friendly way to swiftly lock the files again. Making it so
they can't be found without the need to reopen the app. As this
can take quite some time, depending on the chosen method of
hiding and protecting the DroidStealth app. 

Furthermore, depending on the size, unlocking files could take a
minute or more, as the encryption service would have to perform a
full decryption process. During this process, another notification 
is shown, where the user is informed
of the fact that some files are currently in the process of
being unlocked. Once the user taps on it, the decryption is
canceled by emptying the queue; the current de- or en-cryption is completed.


\subsubsection{Locking and Hiding of DroidStealth}

For an app that prevents others from finding your sensitive
data by means of a casual search, it is required that this app
can't be found easily as well. Obviously, if the app were to be
found by those you want to hide your files from, they will be
convinced that you might have sensitive files hidden. Hence, the
searcher might go further than a casual search, in order to
obtain the sensitive files. We have incorporated a few options to hide 
DroidStealth, and to launch the app using some secret methods.

\textbf{Casual Launch}
The trivial, default way of launching DroidStealth is through the app drawer of an Android device. 
When launching the application the first time, the user is promted to enter a pin that will be used to access the application.
On following launches, the app will present the user with a keyboard to enter the pin of the user. If the pin is correct, the 
DroidStealth will launch into the secret gallery. However, if the pin is incorrect, the user won't be able to enter the application.


\textbf{Hiding from App Drawer}
The user has the option to hide DroidStealth completely from the drawer. This 
means that the user should think of different means of launching the application, 
which will be discussed in the next parts. A limitation is that the app can still be found
in the application list in the Android settings screen. 

\textbf{Launch with Dialer}
The user may select the option to launch the application by calling a special number
in the regular dialer of the phone. Instead of actually calling the filled in number, the
application will be launched, presenting the user with the pin keyboard. Furthermore,
the application removes upon launch the last entry of the call log of the phone, so that
an attacked can't figure out the launch code, by simply checking the call log.

A potential security issue here, is that when a user fills in the wrong launch code, the 
entry won't be removed from the call log, and thus an attacked could be hinted towards
the right pin. Also, if a user had made more mistakes, the attacker could merge the 
suspicious call log entries, and deduct the correct pin. A possible solution would be to
check the call log for entries that are similar to the actual one, and to remove those as well.

\textbf{Launch with Widget}
Another option is to launch the app by means of an invisible widget on the user's home screen. 
When the user adds a widget to the home screen, it will still be visible, until the user presses on it. 
From that point on, when the user presses the invisible widget 5 times, the app is launched, showing the pin keyboard.

When adding a new access widget, all previously placed widgets become visible. This allows 
the user to retrieve forgotten widgets. Of course, this is a potential security threat, as this 
provides attackers an easy way of finding the hidden widget. We must remind ourselves, 
however, that we are focusing on casual search. Also, if this would be combined with
a morphed DroidStealth, attackers would never know which widget of which app should be
placed, unless widget previews are provided.

\subsubsection{Styling}

DroidStealth is themed with a dark color in order to give users the feeling that they are indeed
working in secret, and that their data will be safely hidden. However, the app should not
have an amateuristic feeling about it. This would indicate that the app is potentially unstable, 
since it would give the user the sense that the developers had no sense of perfection. 
Therefore, we used a rounded, but solid straight font for our titles, and a formal font for 
all other texts. Combining this with the use of bright, but slightly softened primary and 
secondary colors, the user is given the feeling that the app handles its tasks well, but in 
the mean time, the user is soothed with a comfortable look. %% TODO: ADD SMALL IMAGE

The use of green and red is mirrored from the conventional meaning of those colors. Green 
will always be used to indicate that something is good or safe, red will do the opposite. 
In addition we have the color orange, which is used to indicate progress. Whenever a file is 
locking, or unlocking, the status bar of the file will be orange, and a animated twirl is shown 
to indicate that the file is being processed. %% TODO: ADD SMALL IMAGE

Finally, the gallery uses no padding or margins between the thumbnails of files, as we want 
to optimally make use of all the screen space. Thumbnails are thus as big as they can be, 
and thus will be most efficient in showing the user its contents. 
