\section{Approach and Design}
\label{sec:approach-and-design}
This section walks though all design choices made with DroidStealth,
and how we approached the problem in order to tackle it. Most 
solutions have drawbacks, which will be discussed further in the
section about future work and limitations. %% ADD REFERENCE

%% Here we say stuff about the libraries and intents because why reinvent the wheel. 
%% WHAT ELSE DO WE TALK ABOUT HERE EXACTLY BESIDES USER EXPERIENCE?
%% NOT SURE IF STRUCTURE HERE WORKS

\subsection{Encryption}
\label{sec:approach-and-design:encryption}

\subsection{Morphing}
\label{sec:approach-and-design:morphing}

Simply hiding a user's data will not be enough to pass the casual search that was described earlier. 
Anyone inspecting a phone that knows of DroidStealth and its functionality would become highly suspicious of any user with the application installed, resulting in more thorough inspection. 
This is something this application was not designed for, which could possibly result in the hidden data becoming compromised. 

From this it follows that not only the data needs to be hidden, but DroidStealth as well. 
Unfortunately, the Android framework does not provide many tools for this. 
This is mainly because the operating system, like most mobile operating systems, is focused on easy application access instead of easy file access. 
Preventing detection meant some unconventional approaches had to be assessed.

There are several obstacles when it comes to staying unnoticed through a casual search on Android. 
The most obvious obstacle is the `app drawer,' which is an overview of all the applications installed on the Android device.
In Android is possible to change the way the app drawer behaves, since it is itself an application as well.
However, changing the app drawer is a radical approach, which many users, especially those not technically literate, would not consider doing.
Since the product was meant to be as easy as possible to install and use, it meant that having an application that behaved as a custom app drawer was not an option.

This meant that the application would have to be able to hide itself.
It would have to be so unnoticeable between the user's other applications, casual search would not expose it immediately. 
Where it led us to another problem, since applications have a name and an icon that stays the same as long as they are not updated by the developer themselves.
Updating continuously would not be an option, since DroidStealth is meant for offline usage, as explained in section \ref{sec:problem-description}. 

Since the developers can not consistently update the appearance of the application, this means it is something the users would need to be able to do themselves.
To achieve this, a novel approach was taken.
For this project we devised a method to allow users to alter the name and icon of DroidStealth without developer intervention, a method which was dubbed `morphing' due to the now fluid appearances DroidStealth.
Unfortunately, due to limitations in Android, users would need to re-install the application after having `morphed' it, but this problem is addressed through the way users share the application.

As expressed in the section \ref{sec:problem-description}, the application should be able to be shared nomadically, meaning there is no central distribution point, but users share the application between each other. 
Combined with the morphing discussed in the previous paragraph, this provides for a good solution for the necessity of reinstalling the application for it to be morphed.
Users can create a morphed version which they can share with other users, so that the application never looks the same, making it near impossible to detect during a casual search.

Sharing the application can be achieved through a multitude of ways on Android, but because of the ease of use and the increasing implementation, Near Field Communication (NFC)\cite{website:nfc-spec} was chosen the main approach for data sharing. 
It is also possible to share through the default sharing system supported by Android,which includes BlueTooth and uploading files to various sharing services, for those devices that do not yet support NFC.

\subsection{User Experience}
\label{sec:approach-and-design:user-experience}

Within this subsection we will briefly elaborate on our design
choices in user experience design related to locking and hiding
of both data and the app. Finally, we briefly discuss the 
philosophy behind the styling. 

\subsubsection{Locking and Hiding of Data}

The most important part of this project, is the ability to hide
files. This means, as mentioned earlier, that hidden media
files should no longer be visible in the media
galleries, and that with a file browser, one still shouldn't be
able to open any of the hidden files, as they would be
encrypted. While the sensitive
files are hidden and locked away, the user wouldn't be able to
directly open the files. Therefore, the user should have the
ability to unlock files, so that the data can be viewed,
shared, and even modified.

Unlocking files potentially causes security risks, they may be
forgotten by the user. Then later found by a third party when the user thought they were safe.
This issue was solved by showing
a clear warning to the user, explaining that some files are
unlocked and that this presents a risk.
The user is shown a persistent notification in the
notification drawer of Android, with the message that some of
the user's files are unlocked. When the notification is pressed,
all unlocked files are immediately locked. This
provides a user friendly way to swiftly lock the files again. Making it so
they can't be found without the need to reopen the app. As this
can take quite some time, depending on the chosen method of
hiding and protecting the DroidStealth app. 

Furthermore, depending on the size, unlocking files could take a
minute or more, as the encryption service would have to perform a
full decryption process. During this process, another notification 
is shown, where the user is informed
of the fact that some files are currently in the process of
being unlocked. Once the user taps on it, the decryption is
canceled by emptying the queue; the current de- or en-cryption is completed.


\subsubsection{Locking and Hiding of DroidStealth}

As described in the problem description the data and the app can't be easy to find.
Yet even as it is made to be hard to find it should still be easy to use.
While at first glance this may seem like contrary goals it does not have to be.
To this purpose we have incorporated several options to stealthily launch DroidStealth when it is hidden.

\textbf{Normal Launch}
The trivial, and default way of launching apps, is through the app drawer of an Android device. 
When launching the application the first time, the user is prompted to enter a pin that will be used to access the application.
On following launches, the app will present the user with a keyboard to enter the pin of the user. 
If the pin is correct, the DroidStealth will launch into the secret gallery.
However, if the pin is incorrect, the user won't be able to enter the application.
This pin will also be requested for all other launch methods. %Is this true?
This is the least obfuscating option, but not necessarily an insecure method.
Earlier we mentioned morphing DroidStealth to look like a different application.
When only morphing is used the resulting name and icon should not stand out from the other apps to prevent easy detection.

The user has the option to hide DroidStealth completely from the drawer. 
This means that the user is can  not turn on this feature unless other means of launching DroidStealth have been set up.
A listing of the other means will be discussed below.  %I think this might not be needed here? And the below is probably for the limitations section?
Important to note is that DroidStealth can still be found in the application list in the Android settings screen.
Meaning that morphing is still important even when the application is not in the app drawer.
As Morphing will change the icon and name for the application list.

\textbf{Launch with Dialer}
The user may select the option to launch the application by dialing a special phone number. 
Instead of actually calling the entered number, the application will be launched, presenting the user with the pin keyboard. 
DroidStealth ensures this number does not show up the call log of the phone when it is launched successfully.
This is so that an attacker can not find the phone number for launching by checking the call log.

%I think this section is meant for the limitations section later on too?
A potential security issue here is that when a user enters an incorrect phone number when trying to start DroidStealth.
The wrong number is not automatically removed from the call log. 
A smart attacker can potentially use this to shrink the search space for a brute force attack.
Though this is generally not feasible for a casual search it could still be an indicator for the presence of DroidStealth if invalid phone numbers are used.
This can potentially be solved would be to check the call log for entries that are similar to the actual one, and to remove those as well.

\textbf{Launch with Widget}
Another option is to launch DroidStealth by means of an 'invisible' widget on the user's home screen. 
When the user adds a widget to the home screen it will be visible.
Until the user presses on it at least, then it will go fully transparent.
Making it impossible to see under normal circumstances.
From that point on when the user presses the invisible widget 5 times DroidStealth is launched.

When adding a new access widget, all previously placed widgets become visible. 
This allows the user to retrieve widgets that have been misplaced.
To provide additional security this should be combined with a morphed DroidStealth.
Morphing obfuscates which widget of what app should be replaced unless widget previews are provided.

\subsubsection{Styling}
%Not sure if this fits right after bits about launch methods. And should those be under user experience if styling is there too?
%Also this says what we did and what it should do. But how do we know that? And was this tested? Maybe actually go into how things were tested?
%Add a bit about user experience testing being part of future work? Does this go across cultures too?
DroidStealth is themed with a dark color in order to give users the feeling that they are indeed
working in secret and that their data will be safe. However, DroidStealth should not
have a hobbyist feel to it. This would indicate that the code is potentially unstable, 
as it would give the user the sense that the developers were not serious or unqualified. 
Therefore, we used a rounded, but solid straight font for our titles, and a formal font for 
all other texts. Combining this with the use of bright, but slightly softened primary and 
secondary colors, the user is given the feeling that the app handles its tasks well, but in 
the mean time, the user is soothed with a comfortable look. %% TODO: ADD SMALL IMAGE

The use of green and red is mirrored from the conventional meaning of those colors. Green %How is that mirrored from the conventional meaning?
will always be used to indicate that something is good or safe, red will do the opposite. 
In addition we have the color orange, which is used to indicate progress. Whenever a file is 
locking, or unlocking, the status bar of the file will be orange, and a animated twirl is shown 
to indicate that the file is being processed. %% TODO: ADD SMALL IMAGE

Finally, the gallery uses no padding or margins between the thumbnails of files, as we want %Maybe mention android standards here?
to optimally make use of all the screen space. Thumbnails are thus as big as they can be, 
and thus will be most efficient in showing the user its contents. 
